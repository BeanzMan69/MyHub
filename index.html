<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
    <title>My Hub</title>
    <style>
        body {
            overflow-x: hidden;
            margin: 0;
            justify-content: center;
            align-items: center;
            background-color: rgb(83, 83, 83);
            position: relative;
            height: 100vh;
            font-family: 'Roboto', sans-serif;
        }

        body.dark-mode {
            background-color: aliceblue;
        }

        header {
            width: 100%;
            height: auto;
            padding: 10px;
            color: aliceblue;
            background-color: rgb(36, 36, 36);
            display: flex;
        }

        header h1 {
            margin-left: 30px;
            cursor: pointer;
        }

        .addButton {
            position: absolute;
            bottom: 30px;
            right: 30px;
            position: fixed;
        }

        .addButton button {
            border-radius: 50%;
            background-color: blueviolet;
            color: aliceblue;
            border: none;
            font-size: 35px;
            width: 60px;
            height: 60px;
            transition: 0.3s ease 0.1s;
            cursor: pointer;
        }

        .addButton button:hover {
            width: 70px;
            height: 70px;
            background-color: rgb(92, 24, 157);
        }

        .load {
            width: 100%;
            height: 100vh;
            background-color: rgba(40, 40, 40, 0.812);
            z-index: 9999;
            display: none;
            position: absolute;
            top: 0;
            left: 0;
        }

        .load2 {
            width: 100%;
            height: 100vh;
            background-color: rgba(40, 40, 40, 0.812);
            z-index: 9999;
            display: none;
            position: absolute;
            top: 0;
            left: 0;
        }

        .details {
            border-radius: 30px;
            background-color: aliceblue;
            width: 500px;
            max-width: 80%;
            height: 400px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .details label {
            font-size: 28px; 
            display: block;
            margin-bottom: 10px; 
        }

        .details input {
            width: 80%;
            max-width: 300px;
            height: 45px;
            border-radius: 20px;
            font-size: 24px; 
            margin-bottom: 20px; 
        }

        .details button {
            width: 100px;
            height: 50px;
            font-size: 40px;
            margin-top: 30px;
            background-color: blueviolet;
            border-radius: 10px;
            color: white;
            border: none;
            transition: 0.3s ease 0.1s;
            cursor: pointer;
        }

        .details button:hover {
            width: 110px;
            height: 60px;
            background-color: rgb(92, 24, 157);
        }

        .shortCut {
            width: 300px;
            height: 250px;
            border-radius: 30px;
            text-align: center;
            align-items: center;
            background-color: rgba(40, 40, 40, 0.8);
            margin-top: 10px;
            display: inline-block; 
            margin-right: 10px;
            cursor: pointer;
            z-index: 6;
            position: relative;
        }  

        @keyframes smallMove {
            0% {
                width: 300px;
                height: 250px;
            }
            50% {
                width: 310px;
                height: 260px;
            }

            100% {
                width: 300px;
                height: 250px;
            }
        }

        .shortCut:hover {
            animation: smallMove 3s ease infinite;
        }

        .shortCut iframe {
            margin-top: 20px;
            pointer-events: none;
        }

        .shareButton {
            top: 20px;
            right: 20px;
            position: fixed;
        }

        .shareButton img {
            border-radius: 50%;
            width: 60px;
            height: 60px;
            transition: 0.3s ease 0.1s;
            cursor: pointer;
        }

        .shareButton img:hover {
            width: 70px;
            height: 70px;
            transform: rotate(360deg);
        }

        .shareButton button {
            border-radius: 50%;
            background: none;
            border: none;
        }

        .details2 {
            border-radius: 30px;
            background-color: aliceblue;
            width: 800px;
            max-width: 80%;
            height: fit-content;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .details2 h2 {
            font-size: 28px;
            word-wrap: break-word;
            word-break: break-word;
            overflow: hidden;
        }

        .details2 button {
            width: 100px;
            height: 50px;
            font-size: 40px;
            margin-top: 30px;
            background-color: blueviolet;
            border-radius: 10px;
            color: white;
            border: none;
            transition: 0.3s ease 0.1s;
            cursor: pointer;
        }

        .details2 button:hover {
            width: 110px;
            height: 60px;
            background-color: rgb(92, 24, 157);
        }

        .settings {
            width: 30px;
            height: 30px;
            font-size: 16px;
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: white; 
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .menu p {
            width: 100%;
        }

        .menu p:hover {
            text-decoration: underline;
        }

        #goToMenu {
            height: 70px;
            border-radius: 50%;
            border: none;
            transition: 0.5s ease-in-out 0.1s;
            display: inline-block;
            margin-top: 7px;
            width: 70px;
            cursor: pointer;
            opacity: 0.5;
        }

        header h1:hover + #goToMenu {
            opacity: 10;
        }

        #goToMenu:hover {
            opacity: 10;
        }

        header button {
            background-color: transparent;
            border: none;
            width: min-content;
            height: min-content;
        }

        .mainMenu {
            border-radius: 30px;
            background-color: aliceblue;
            width: 500px;
            max-width: 80%;
            height: 400px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            flex-direction: column;
            gap: 20px;
        }

        .load3 {
            width: 100%;
            height: 100vh;
            background-color: rgba(40, 40, 40, 0.812);
            z-index: 9999;
            display: none;
            position: absolute;
            top: 0;
            left: 0;
        }

        .mainMenu button {
            width: 100px;
            height: 50px;
            font-size: 40px;
            margin-top: 250px;
            background-color: blueviolet;
            border-radius: 10px;
            color: white;
            border: none;
            transition: 0.3s ease 0.1s;
            cursor: pointer;
            margin: 0 auto;
        }

        .mainMenu button:hover {
            width: 110px;
            height: 60px;
            background-color: rgb(92, 24, 157);
        }

        #darkMode {
            width: 50px;
            height: 50px;
            left: 50px;
            margin-left: 45%;
        } 
    </style>
</head>
<body>
    <header>
        <h1>My Hub</h1>
        <button onclick="menuTime()">
            <img src="http://pixsector.com/cache/db444a5d/av3408bf9a8e4c42e82ae.png" alt="menu" id="goToMenu">
        </button>
    </header>
    <div class="addButton">
        <button onclick="add()">+</button>
    </div>
    <div class="shareButton">
        <button onclick="share()">
            <img src="https://purepng.com/public/uploads/medium/share-icon-qvb.png" alt="Share">
        </button>
    </div>
    <section class="load">
        <div class="details">
            <label>
                Name:
                <br>
                <input type="text" id="detailsName">
            </label>
            <br>
            <label>
                ShortCut URL:
                <br>
                <input type="url" id="detailsUrl" placeholder="Start with https://">
            </label>
            <button onclick="go()">Go</button>
        </div>
    </section>
    <section class="load2">
        <div class="details2">
            <h2>Shareable URL: </h2>
            <h2 id="shareableURL"></h2>
            <button onclick="shareBye()">Ok</button>
        </div>
    </section>
    <section class="load3">
        <div class="mainMenu">
            <label for="darkMode">Dark Mode Toggle <br> (Checked is light mode)</label>
            <input type="checkbox" id="darkMode" onchange="toggleDarkMode()">
            <button onclick="menuBye()">Ok</button>      
        </div>
    </section>
    <script>
        function add() {
            var load = document.querySelector('.load');
            load.style.display = "block";
        }

        function saveShortcutsToLocalStorage(shortcutsData) {
            localStorage.setItem('shortcuts', JSON.stringify(shortcutsData));
        }

        function menuTime() {
            var main = document.querySelector('.load3');

            main.style.display = "flex";
        }

        function menuBye() {
            var main = document.querySelector('.load3');

            main.style.display = "none";
        }

        function toggleDarkMode() {
            var checkbox = document.getElementById('darkMode');
            var body = document.body;

            if (checkbox.checked) {
                body.classList.add('dark-mode');
                localStorage.setItem('dark', 'on');
            } else {
                body.classList.remove('dark-mode');
                localStorage.setItem('dark', 'off');
            }
        }

        function go() {
            var load = document.querySelector('.load');
            var name = document.querySelector('#detailsName').value;
            var url = document.querySelector('#detailsUrl').value;

            var shortcut = {
                name: name,
                url: url
            };

            var shortcuts = JSON.parse(localStorage.getItem('shortcuts')) || [];
            
            localStorage.removeItem('shortcuts');
            shortcuts.push(shortcut);
            localStorage.setItem('shortcuts', JSON.stringify(shortcuts));

            createShortcutElement(name, url);

            document.querySelector('#detailsName').value = "";
            document.querySelector('#detailsUrl').value = "";
            load.style.display = "none";
        }

        function createShortcutElement(name, url) {
            var newShort = document.createElement('div');
            newShort.classList.add('shortCut');

            var h2 = document.createElement('h2');
            h2.style.color = "white";
            h2.textContent = name;

            var iframeContainer = document.createElement('div');
            iframeContainer.style.position = "relative";
            iframeContainer.style.width = "100%";
            iframeContainer.style.height = "100%";

            var iframe = document.createElement('iframe');
            iframe.src = url;
            iframe.style.width = "80%";
            iframe.style.height = "50%";
            iframe.style.border = "none";
            iframe.style.borderRadius = "20px";
            iframe.style.zIndex = "0";

            var settings = document.createElement('button');
            settings.classList.add("settings");
            settings.style.border = "none";
            settings.style.borderRadius = "50%";
            settings.innerHTML = "&#9881;";

            iframeContainer.appendChild(iframe);
            newShort.appendChild(h2);
            newShort.appendChild(iframeContainer);
            newShort.appendChild(settings);

            newShort.addEventListener('click', function () {
                window.open(url, '_blank');
            });

            settings.addEventListener('click', function(event) {
                event.stopPropagation();

                var menu = document.createElement('div');
                menu.classList.add('menu');
                menu.style.position = 'absolute';
                menu.style.top = '40px'; 
                menu.style.right = '15px';
                menu.style.backgroundColor = 'white';
                menu.style.border = '1px solid black';
                menu.style.borderRadius = '5px';
                menu.style.padding = '5px';

                var deleteOption = document.createElement('p');
                deleteOption.textContent = 'Delete';

                deleteOption.addEventListener('click', function(event) {
                    event.stopPropagation();
                    if (newShort.parentNode) {
                        newShort.parentNode.removeChild(newShort);

                        var storedShortcuts = JSON.parse(localStorage.getItem('shortcuts')) || [];

                        storedShortcuts = storedShortcuts.filter(shortcut => {
                            return !(shortcut.name === name && shortcut.url === url);
                        });

                        saveShortcutsToLocalStorage(storedShortcuts);
                    }
                    menu.remove();
                });

                menu.appendChild(deleteOption);
                newShort.appendChild(menu);

                document.addEventListener('click', function closeMenu(e) {
                    if (!menu.contains(e.target) && e.target !== settings) {
                        menu.remove();
                        document.removeEventListener('click', closeMenu);
                    }
                });
            });


            document.body.appendChild(newShort);
        }

        function share() {
            var shortcutsData = [];

            var shortcuts = Array.from(document.querySelectorAll('.shortCut'));
            shortcuts.forEach(shortcut => {
                var name = shortcut.querySelector('h2').textContent;
                var iframeSrc = shortcut.querySelector('iframe').src;

                var singleShortcut = {
                    name: name,
                    url: iframeSrc
                };

                shortcutsData.push(singleShortcut);
            });

            saveShortcutsToLocalStorage(shortcutsData);

            var encodedURLs = encodeURIComponent(JSON.stringify(shortcutsData));
            var randomString = Math.random().toString(36).substring(7);
            var shareableURL = window.location.href + '?data=' + randomString + '&shortcuts=' + encodedURLs;

            var shareableURLElement = document.getElementById("shareableURL");
            shareableURLElement.textContent = 'Copy This: ' + shareableURL;

            var load2 = document.querySelector(".load2");
            load2.style.display = "block";
        }

        function loadShortcutsFromLocalStorage() {
            const storedShortcuts = JSON.parse(localStorage.getItem('shortcuts'));

            if (storedShortcuts && storedShortcuts.length > 0) {
                storedShortcuts.forEach(shortcut => {
                    createShortcutElement(shortcut.name, shortcut.url);
                });
            }
        }

        (function () {
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);

            if (urlParams.has('shortcuts')) {
                const encodedURLs = urlParams.get('shortcuts');
                const decodedURLs = decodeURIComponent(encodedURLs);
                const shortcuts = JSON.parse(decodedURLs);

                if (shortcuts && shortcuts.length > 0) {
                    shortcuts.forEach(shortcut => {
                        createShortcutElement(shortcut.name, shortcut.url);
                    });
                }
            }
        })();

        function shareBye() {
            const load2 = document.querySelector(".load2");

            load2.style.display = "none";
        }

        window.onload = function () {
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);

            // Get the base URL of the current page
            const currentURL = window.location.href.split('?')[0];

            if (urlParams.has('shortcuts')) {
                const encodedURLs = urlParams.get('shortcuts');
                const decodedURLs = decodeURIComponent(encodedURLs);
                const shortcuts = JSON.parse(decodedURLs);

                // Check if the base URL of the shared URL matches the current page's base URL
                const sharedURL = document.createElement('a');
                sharedURL.href = shortcuts[0].url; // Assuming the first shared URL is enough for comparison
                const sharedBaseURL = sharedURL.href.split('?')[0];

                if (sharedBaseURL === currentURL) {
                shortcuts.forEach(shortcut => {
                    createShortcutElement(shortcut.name, shortcut.url);
                });
                }
            } else {
                loadShortcutsFromLocalStorage(); // Load user's shortcuts from localStorage
            }

            const body = document.body;
            const darkMode = localStorage.getItem('dark');
            const darkModeCheckbox = document.getElementById('darkMode'); // Get the checkbox element

            if (darkMode === 'on') {
                body.classList.add('dark-mode');
                darkModeCheckbox.checked = true; // Set the checkbox as checked
            } else {
                body.classList.remove('dark-mode');
                darkModeCheckbox.checked = false; // Ensure checkbox is unchecked if 'dark' is 'off'
            }
        };
    </script>
</body>
</html>
